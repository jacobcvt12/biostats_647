---
title: "Homework 8"
author: "Jacob Carey"
date: \today
header-includes:
    - \usepackage{amsthm}
    - \usepackage{mathtools}
output: pdf_document
---

```{r libs, echo=FALSE}
library(ggplot2)
theme_set(theme_classic())
set.seed(1)
```

1. Here I show a running mean of draws from a specified distribution to show that the sample average converges in distribution to the expected value.
```{r p1}
# number of draws
trials <- 1e4
x <- 1:trials

# normal
normal <- rnorm(trials, mean=5, sd=1)
plot(x, cumsum(normal) / x, main="Normal(5, 1)")
abline(a=5, b=0)

# bernoulli
bernoulli <- rbinom(trials, 1, 0.4)
plot(x, cumsum(bernoulli) / x, main="Bernoulli(0.4)")
abline(a=0.4, b=0)

# poisson
poisson <- rpois(trials, 5)
plot(x, cumsum(poisson) / x, main="Poisson(5)")
abline(a=5, b=0)
```

2.
```{r p2}
trials <- 300

# normal
normal <- matrix(rnorm(100 * trials, 5, 1), ncol=trials)
g <- colMeans(normal)
qplot(g, geom="density") + 
    stat_function(fun=dnorm, args=list(mean=5, sd=sqrt(1/100)), colour="blue")

# bernoulli
bernoulli <- matrix(rbinom(100 * trials, 1, 0.4), ncol=trials)
g <- colMeans(bernoulli)
qplot(g, geom="density") + 
    stat_function(fun=dnorm, args=list(mean=0.4, sd=sqrt(0.4*0.6/100)), colour="blue")

# poisson
poisson <- matrix(rpois(100 * trials, 5), ncol=trials)
g <- colMeans(poisson)
qplot(g, geom="density") + 
    stat_function(fun=dnorm, args=list(mean=5, sd=sqrt(5/100)), colour="blue")
```

3.

4.
